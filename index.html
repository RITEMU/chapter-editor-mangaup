<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù¾Ø±Ø¯Ø§Ø²Ø´Ú¯Ø± ØªØµÙˆÛŒØ±</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
<style>
:root {
--primary: #2563eb;
--primary-hover: #1d4ed8;
--bg: #f8fafc;
--border: #e2e8f0;
--text: #1a1a1a;
}

[data-theme="dark"] {
--primary: #3b82f6;
--primary-hover: #2563eb;
--bg: #1a1a1a;
--border: #333;
--text: #fff;
}

* {
margin: 0;
padding: 0;
box-sizing: border-box;
font-family: system-ui, -apple-system, sans-serif;
}

body {
background: var(--bg);
padding: 2rem;
min-height: 100vh;
color: var(--text);
transition: all 0.3s ease;
}

.container {
max-width: 800px;
margin: 0 auto;
background: var(--bg);
padding: 2rem;
border-radius: 1rem;
box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2);
border: 1px solid var(--border);
}

.form-group {
margin-bottom: 1.5rem;
}

label {
display: block;
margin-bottom: 0.5rem;
font-weight: 500;
}

input[type="number"],
input[type="range"],
select {
width: 100%;
padding: 0.5rem;
border: 1px solid var(--border);
border-radius: 0.5rem;
font-size: 1rem;
background: var(--bg);
color: var(--text);
}

button {
background: var(--primary);
color: white;
border: none;
padding: 0.75rem 1.5rem;
border-radius: 0.5rem;
font-weight: 500;
cursor: pointer;
width: 100%;
font-size: 1rem;
}

button:hover {
background: var(--primary-hover);
}

.theme-toggle {
position: fixed;
top: 1rem;
right: 1rem;
padding: 0.5rem;
border-radius: 50%;
background: var(--primary);
color: white;
cursor: pointer;
border: none;
width: 40px;
height: 40px;
}

.file-tree {
border: 1px solid var(--border);
border-radius: 0.5rem;
padding: 1rem;
margin-top: 1rem;
max-height: 300px;
overflow-y: auto;
}

.folder {
margin-bottom: 1rem;
}

.folder-name {
font-weight: bold;
margin-bottom: 0.5rem;
}

.file-list {
list-style: none;
padding-right: 1.5rem;
}

.file-item {
padding: 0.25rem 0;
cursor: move;
display: flex;
align-items: center;
}

.file-item::before {
content: "â”œâ”€â”€ ";
color: var(--border);
margin-left: 0.5rem;
}

.file-item:last-child::before {
content: "â””â”€â”€ ";
}

.progress-container {
margin-top: 1.5rem;
}

.progress {
position: relative;
height: 10px;
background: var(--border);
border-radius: 5px;
overflow: hidden;
display: none;
}

.progress-bar {
height: 100%;
background: linear-gradient(90deg, var(--primary) 0%, var(--primary-hover) 100%);
width: 0;
transition: width 0.3s ease;
position: relative;
overflow: hidden;
}

.progress-bar::after {
content: "";
position: absolute;
top: 0;
left: 0;
right: 0;
bottom: 0;
background: linear-gradient(
90deg,
transparent 0%,
rgba(255, 255, 255, 0.2) 50%,
transparent 100%
);
animation: shimmer 1.5s infinite;
}

@keyframes shimmer {
from { transform: translateX(-100%); }
to { transform: translateX(100%); }
}

.status {
margin-top: 1rem;
text-align: center;
color: var(--text);
font-weight: 500;
}

</style>
</head>
<button class="theme-toggle" id="themeToggle">ðŸŒ“</button>
<div class="container">
<!-- [Previous form groups remain unchanged] -->

<div class="file-tree" id="fileTree"></div>

<!-- [Previous form groups remain unchanged] -->

<div class="progress-container">
<div class="progress" id="progressBar">
<div class="progress-bar" id="progressBarFill"></div>
</div>
<div class="status" id="statusText"></div>
</div>
</div>

<script>
// [Previous JavaScript code remains unchanged until the file handling part]

function updateFileTree() {
const fileTree = document.getElementById('fileTree');
fileTree.innerHTML = '';

files.forEach((folderFiles, folderName) => {
const folderDiv = document.createElement('div');
folderDiv.className = 'folder';

const folderNameDiv = document.createElement('div');
folderNameDiv.className = 'folder-name';
folderNameDiv.textContent = folderName + '/';

const fileList = document.createElement('ul');
fileList.className = 'file-list';

folderFiles.forEach(file => {
const fileItem = document.createElement('li');
fileItem.className = 'file-item';
fileItem.textContent = file.name;
fileItem.dataset.path = file.webkitRelativePath;
fileList.appendChild(fileItem);
});

folderDiv.appendChild(folderNameDiv);
folderDiv.appendChild(fileList);
fileTree.appendChild(folderDiv);

// Enable drag and drop sorting
new Sortable(fileList, {
animation: 150,
onEnd: function(evt) {
const folderFiles = Array.from(evt.to.children).map(li => {
const path = li.dataset.path;
return Array.from(fileInput.files).find(f => f.webkitRelativePath === path);
});
files.set(folderName, folderFiles);
}
});
});
}

// Replace updateFileList with updateFileTree in the file input event listener
fileInput.addEventListener('change', () => {
files.clear();
Array.from(fileInput.files)
.filter(file => file.type.startsWith('image/'))
.sort((a, b) => a.name.localeCompare(b.name))
.forEach(file => {
const folderPath = file.webkitRelativePath.split('/')[0];
if (!files.has(folderPath)) {
files.set(folderPath, []);
}
files.get(folderPath).push(file);
});
updateFileTree();
});

// Add dark mode toggle
const themeToggle = document.getElementById('themeToggle');
let isDarkMode = false;

themeToggle.addEventListener('click', () => {
isDarkMode = !isDarkMode;
document.documentElement.setAttribute('data-theme', isDarkMode ? 'dark' : 'light');
});

// [Rest of the JavaScript code remains unchanged]
</script>
</body>
</html>
